![Aetheric Banner](https://github.com/aetheric-oss/.github/raw/main/assets/doc-banner.png)

# Interface Control Document (ICD) - `svc-pricing`

## :telescope: Overview

This document details the endpoints provided by the `svc-pricing` service.

Autogenerated client-side functions for this gRPC server are conveniently packaged in the `svc-pricing-client` crate, to be used by svc-cargo, svc-rideshare, and other customer-facing services.

### Metadata

| Attribute     | Description                                                       |
| ------------- |-------------------------------------------------------------------|
| Maintainer(s) | [Aetheric Realm Team](https://github.com/orgs/aetheric-oss/teams/dev-realm) |
| Stuckee       | [@amsmith-pro](https://github.com/amsmith-pro)                        |
| Status        | Development                                                       |

## :books: Related Documents

Document | Description
--- | ---
[High-Level Concept of Operations (CONOPS)](https://github.com/aetheric-oss/se-services/blob/develop/docs/conops.md) | Overview of Aetheric microservices.
[High-Level Interface Control Document (ICD)](https://github.com/aetheric-oss/se-services/blob/develop/docs/icd.md) | Interfaces and frameworks common to all Aetheric microservices.
[Requirements - `svc-pricing`](https://nocodb.aetheric.nl/dashboard/#/nc/view/045288a8-3875-4429-bdaa-9f578275adef) | Requirements and user stories for this microservice.
[Concept of Operations - `svc-pricing`](./conops.md) | Defines the motivation and duties of this microservice.
[Software Design Document (SDD) - `svc-pricing`](./sdd.md) | Specifies the internal activity of this microservice.
[Uber Elevate White Paper](https://evtol.news/__media/PDFs/UberElevateWhitePaperOct2016.pdf) | Uber's research on UAM operations. Certain economic assumptions are referenced by Arrow's pricing model.

## :hammer: Frameworks

See the [High-Level Services ICD](https://github.com/aetheric-oss/se-services/blob/develop/docs/icd.md).

## :speech_balloon: gRPC

### Files

These interfaces are defined in a protocol buffer file, [`grpc.proto`](../proto/grpc.proto).

### Integrated Authentication & Encryption

See [High-Level Services ICD](https://github.com/aetheric-oss/se-services/blob/develop/docs/icd.md).

### gRPC Protocol Documentation

#### `ReadyResponse`
If the service is ready to use.


| Field | Type | Description |
| ----- | ---- | ----------- |
| `ready` | bool |  `true` if the service is ready, `false` otherwise. |


#### `PricingResponse`
Price for a given flight. 

| Field | Type | Description |
| ----- | ---- | ----------- |
| `prices` | [float] |An array of prices, one for each requested leg of the trip |

#### `ReadyRequest`
A ping to a heartbeat service to see if `svc-pricing` is ready to use.


| Field | Type | Description |
| ----- | ---- | ----------- |
| `arbitrary` | bool  | An arbitrary value |

#### `PricingRequest`
Get the price for a type of service.

:exclamation: This is still WIP as we continue to refine our pricing model. For testing purposes, rideshare type will return a price that is half of that of cargo; and charter will be twice.

An extra field to be added in the near future is `weight` as the weight of the payload affects power consumption, which would influence the pricing.

Two required fields:
- `service_type`: the type of service. 0 = cargo, 1 = rideshare, 2 =
  charter
- `distance_km`: the distance of the trip in km
- `weight_kg`: the weight of the parcel

### gRPC Server Methods ("Services")

gRPC server methods are called "services", unfortunately name clashing with the broader concept of web services.
| Service | Description |
| ---- | ---- |
| `IsReady` | Returns a message indicating if this service is ready for requests.<br> <br>Similar to a health check, if a server is not "ready" it could be considered dead by the client making the request.<br> <br> Also see [`ReadyRequest`](#readyrequest), [`ReadyResponse`](#readyresponse).
| `GetPricing` | Returns a float value representing the price for a given flight trip, denominated in USD.<br> <br> Also see [`PricingRequest`](#pricingrequest), [`PricingResponse`](#pricingresponse).|

### gRPC Client Methods ("Requests")

| Request | Description |
| ------    | ------- |
| `PricingRequest` | See [`PricingRequest`](#pricingrequest)
| `ReadyRequest` | See [`ReadyRequest`](#readyrequest) |
